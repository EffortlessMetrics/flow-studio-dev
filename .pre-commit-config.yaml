repos:
  - repo: local
    hooks:
      - id: swarm-validate
        name: Validate swarm spec/impl alignment (strict)
        entry: uv run swarm/tools/validate_swarm.py --strict
        language: system
        pass_filenames: false
        stages: [commit]

      - id: selftest-ac-freshness
        name: Selftest AC Matrix Freshness Check
        entry: uv run swarm/tools/check_selftest_ac_freshness.py
        files: ^(features/selftest\.feature|docs/SELFTEST_.*\.md|swarm/tools/selftest.*\.py)$
        language: system
        pass_filenames: false
        stages: [commit]

      - id: selftest-ac-tests
        name: Selftest AC Traceability Tests
        entry: uv run pytest tests/test_selftest_ac_*.py -v
        files: ^(features/selftest\.feature|docs/SELFTEST_.*\.md|swarm/tools/selftest.*\.py|tests/test_selftest_ac.*\.py)$
        language: system
        pass_filenames: false
        require_serial: true
        stages: [commit]

      - id: selftest-degradation-tests
        name: Selftest Degradation System Tests
        entry: uv run pytest tests/test_selftest_degradation*.py -v
        files: ^(swarm/tools/selftest.*\.py|swarm/tools/show_selftest.*\.py|tests/test_selftest_degradation.*\.py)$
        language: system
        pass_filenames: false
        require_serial: true
        stages: [commit]
